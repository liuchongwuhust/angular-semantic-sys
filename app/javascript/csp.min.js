/*! csp 2017-03-07 */
function cspManageProductFileChange(a){var b=a.value;if(""===b)document.getElementById("csp_manage_product_delete_button").click();else{var c=(b.substring(12),b.split(".")),d="";c.length>1&&(d=c[c.length-1].toLowerCase()),"jpg"!==d&&"png"!==d&&"bmp"!==d?document.getElementById("csp_manage_product_error_button").click():document.getElementById("csp_manage_product_right_button").click()}}function cspManageSelectFile(){document.getElementById("csp_manage_file_input").click()}function cspManageanalogProductFileChange(a){var b=a.value;if(""===b)document.getElementById("csp_manage_analogProduct_delete_button").click();else{var c=(b.substring(12),b.split(".")),d="";c.length>1&&(d=c[c.length-1].toLowerCase()),"jpg"!==d&&"png"!==d&&"bmp"!==d?document.getElementById("csp_manage_analogProduct_error_button").click():document.getElementById("csp_manage_analogProduct_right_button").click()}}function cspModuleFileChange(a){var b=a.value;if(""===b);else{var c=(b.substring(12),b.split(".")),d="";c.length>1&&(d=c[c.length-1].toLowerCase()),"jpg"!==d&&"png"!==d&&"bmp"!==d?document.getElementById("csp_module_file_tips_label").innerText="仅支持JPG,PNG,BMP格式的图片":document.getElementById("csp_module_file_commit").click()}}function cspManageImportLoadFileChange(a){var b=a.value;if(""===b);else{var c=(b.substring(12),b.split(".")),d="";c.length>1&&(d=c[c.length-1].toLowerCase()),"csv"!==d&&"xlsx"!==d&&"xls"!==d?document.getElementById("csp_manage_import_file_error_btn").click():document.getElementById("csp_manage_import_file_load_btn").click()}}function cspCustomerImportLoadFileChange(a){var b=a.value;if(""===b);else{var c=(b.substring(12),b.split(".")),d="";c.length>1&&(d=c[c.length-1].toLowerCase(),console.log("yyyyyyyyyy",d)),"csv"!==d&&"xlsx"!==d&&"xls"!==d&&document.getElementById("csp_customer_import_file_error_btn").click()}}function cspModuleImgLoad(a){a.width>a.height?(a.style.width="auto",a.style.height="150px"):(a.style.width="150px",a.style.height="auto");var b=(150-a.width)/2+"px",c=(150-a.height)/2+"px";a.style.marginLeft=b,a.style.marginTop=c}function cspModuleBigImgLoad(a){console.log(window.innerWidth,window.innerHeight),console.log(a.src,a.width,a.height),a.width>=window.innerWidth&&a.height<window.innerHeight&&(console.log("宽缩小，高自动"),a.style.width="100%",a.style.height="auto"),a.width>=window.innerWidth&&a.height>=window.innerHeight&&(1e3*a.width/window.innerWidth>1e3*a.height/window.innerHeight?(console.log("宽缩小，高自动"),a.style.width="100%",a.style.height="auto"):(console.log("高缩小，宽自动"),a.style.width="auto",a.style.height="100%")),a.width<window.innerWidth&&a.height>=window.innerHeight&&(console.log("高缩小，宽自动"),a.style.width="auto",a.style.height="100%");var b=-a.width/2+"px",c=-a.height/2+"px";console.log(b,c),a.style.marginLeft=b,a.style.marginTop=c}function cspManageThemesMouseOver(a){a.style.backgroundColor="#d5d5d5"}function cspManageThemesMouseOut(a){a.style.backgroundColor="white"}function getMinimum(a){for(var b=a[0],c=1;c<a.length;c++)b>a[c]&&(b=a[c]);return b}function getMaximum(a){for(var b=a[0],c=1;c<a.length;c++)b<a[c]&&(b=a[c]);return b}function cspManageSpotLoadFileChange(a){var b=a.value;if(""===b);else{var c=(b.substring(12),b.split(".")),d="";c.length>1&&(d=c[c.length-1].toLowerCase()),"csv"!==d&&"xlsx"!==d&&"xls"!==d?document.getElementById("csp_manage_spot_file_error_btn").click():document.getElementById("csp_manage_spot_file_load_btn").click()}}function cspManageFuturesLoadFileChange(a){var b=a.value;if(""===b);else{var c=(b.substring(12),b.split(".")),d="";c.length>1&&(d=c[c.length-1].toLowerCase()),"csv"!==d&&"xlsx"!==d&&"xls"!==d?document.getElementById("csp_manage_futures_file_error_btn").click():document.getElementById("csp_manage_futures_file_load_btn").click()}}function loadStockFileChange(a){var b=a.value;if(""===b)document.getElementById("stockfile_error_btn").click();else{var c=b.split("."),d="";c.length>1?d=c[c.length-1].toLowerCase():document.getElementById("stockfile_error_btn").click(),"csv"!==d&&"xlsx"!==d&&"xls"!==d?document.getElementById("stockfile_error_btn").click():document.getElementById("stockfile_load_btn").click()}}function calculateIndexes(a,b,c){var d=[];a=a>b?b:a;var e=Math.round(a-c/2),f=Math.round(a+c/2);console.log("start",e,"end",f),e<1&&(e=1),f!=e+c-1&&(f=e+c-1),f>b&&(f=b),f-c+1<e&&(e=f-c+1>0?f-c+1:1);for(var g=e;g<=f;g++){var h={};h.page=g,g==a?h.select=!0:h.select=!1,d.push(h)}return console.log(d),d}function cspOperLoginBgChange(){window.innerHeight<=400?document.getElementById("csp_oper_login_html").style.height="400px":document.getElementById("csp_oper_login_html").style.height="100%"}function cspManageNewNoticeFileChange(a){var b=a.value;if(""===b)document.getElementById("csp_manage_newnotice_file_delete_button").click();else{var c=(b.substring(12),b.split(".")),d="";c.length>1&&(d=c[c.length-1].toLowerCase(),"pdf"===d&&document.getElementById("csp_manage_newnotice_file_right_button").click())}}function cspManageLoadUserLoadFileChange(a){var b=a.value;if(""===b);else{var c=(b.substring(12),b.split(".")),d="";c.length>1&&(d=c[c.length-1].toLowerCase()),"csv"!==d&&"xlsx"!==d&&"xls"!==d?document.getElementById("csp_manage_futures_file_error_btn").click():document.getElementById("csp_manage_futures_file_load_btn").click()}}function cspManageLoadBoughtLoadFileChange(a){var b=a.value;if(""===b);else{var c=(b.substring(12),b.split(".")),d="";c.length>1&&(d=c[c.length-1].toLowerCase()),"csv"!==d&&"xlsx"!==d&&"xls"!==d?document.getElementById("csp_manage_loadbought_file_error_btn").click():document.getElementById("csp_manage_loadbought_file_load_btn").click()}}var cspApp=angular.module("cspApp",["cspRouters","cspCtrls","cspServices","cspFilters","oc.lazyLoad"]),cspCtrls=angular.module("cspCtrls",[]);cspCtrls.controller("AppCtrl",["$scope","$state",function(a,b){}]),cspCtrls.controller("allocateStockCtrl",function(a,b){a.allocateStockCtrlInit=function(){document.getElementById("csp_header_containter").style.display="none",document.getElementById("csp_footer").style.display="none",document.getElementById("homeSpaceDiv_37px").style.display="none",window.scrollTo(0,0)}}),cspCtrls.controller("cspOperLoginCtrl",function(a,b,c,d){a.timePromise=void 0,a.loginInfo={},a.cspOperLoginInit=function(){document.getElementById("csp_header_containter").style.display="none",document.getElementById("csp_footer").style.display="none",document.getElementById("homeSpaceDiv_37px").style.display="none",document.cookie||navigator.cookieEnabled?d.cspOperCheckLogin({},function(e){if("succeed"==e.result&&1==e.loginState)b.go("allocateStock");else{for(var f,g=!1,h="cspOperLoginInfo=",i=document.cookie.split(";"),j=0;j<i.length;j++){var k=i[j].trim();if(0==k.indexOf(h)){g=!0,f=JSON.parse(unescape(k.substring(h.length,k.length)));break}}if(g){a.loginInfo.maid=f.maid,a.loginInfo.oid=f.oid,a.loginInfo.password=f.password,a.loginInfo.logining=!0,a.loginInfo.loadState="正在登录",a.loginInfo.error=!1,a.loginInfo.save=f.save;var l={};l.login_maid=a.loginInfo.maid,l.login_oid=a.loginInfo.oid,l.login_pass=a.loginInfo.password,d.cspOperLogin(l,function(d){if("succeed"==d.result)a.loginInfo.loadState="登录成功",b.go("allocateStock");else{var e=2;a.loginInfo.error=!0,a.loginInfo.loadState=d.reason,a.timePromise=void 0,a.timePromise=c(function(){e<=0?(c.cancel(a.timePromise),a.timePromise=void 0,a.loginInfo.logining=!1):e--},500,100)}})}else a.loginInfo.maid="",a.loginInfo.oid="",a.loginInfo.password="",a.loginInfo.logining=!1,a.loginInfo.loadState="正在登录",a.loginInfo.error=!1,a.loginInfo.save=!1}}):alert("浏览器未开启cookie,网站可能无法正常使用")},a.cspOperLoginClick=function(){var e=1;if(a.loginInfo.logining=!0,a.loginInfo.error=!1,a.loginInfo.loadState="正在登录",a.loginInfo.error=!1,""==a.loginInfo.maid)a.loginInfo.error=!0,a.loginInfo.loadState="请输入资产管理人编号",a.timePromise=void 0,a.timePromise=c(function(){e<=0?(c.cancel(a.timePromise),a.timePromise=void 0,a.loginInfo.logining=!1):e--},500,100);else if(""==a.loginInfo.oid)a.loginInfo.error=!0,a.loginInfo.loadState="请输入操作员账号",a.timePromise=void 0,a.timePromise=c(function(){e<=0?(c.cancel(a.timePromise),a.timePromise=void 0,a.loginInfo.logining=!1):e--},500,100);else if(""==a.loginInfo.password)a.loginInfo.error=!0,a.loginInfo.loadState="请输入密码",a.timePromise=void 0,a.timePromise=c(function(){e<=0?(c.cancel(a.timePromise),a.timePromise=void 0,a.loginInfo.logining=!1):e--},500,100);else{var f={};f.login_maid=a.loginInfo.maid,f.login_oid=a.loginInfo.oid,f.login_pass=a.loginInfo.password,d.cspOperLogin(f,function(d){if("succeed"==d.result){if(a.loginInfo.loadState="登录成功",console.log(a.loginInfo.save),1==a.loginInfo.save){var f={};f.maid=a.loginInfo.maid,f.oid=a.loginInfo.oid,f.password=a.loginInfo.password,f.save=a.loginInfo.save;var g=JSON.stringify(f),h=new Date;h.setTime(h.getTime()+6048e5);var i="cspOperLoginInfo="+escape(g)+";expires="+h.toGMTString();document.cookie=i}else{var j="cspOperLoginInfo=",h=new Date;h.setTime(h.getTime());for(var k=document.cookie.split(";"),l=0;l<k.length;l++){var m=k[l].trim();if(0==m.indexOf(j)){document.cookie=m+";expires="+h.toGMTString();break}}}b.go("allocateStock")}else a.loginInfo.error=!0,a.loginInfo.loadState=d.reason,a.timePromise=void 0,a.timePromise=c(function(){e<=0?(c.cancel(a.timePromise),a.timePromise=void 0,a.loginInfo.logining=!1):e--},500,100)})}}}),cspCtrls.controller("cspOperLoginOutCtrl",function(a,b,c,d){a.cspOperLoginOutLoad=function(){d.cspOperLoginOut({},function(a){if(document.cookie||navigator.cookieEnabled){var c="cspOperLoginInfo=",d=new Date;d.setTime(d.getTime()),document.cookie=c+";expires="+d.toGMTString()}b.go("operlogin")})}}),cspCtrls.controller("randomCtrl",function(a,b,c,d,e){function f(b,c){if(console.log("分券trid",b),b){var d={trid:"",maid:""};d.maid="1",d.trid=b,e.unitRandmDiv(d,function(f){if(f.successOr){console.log("分券成功",f.successOr),e.deleWishList(d,function(a){a.delWish&&console.log("上一次的心愿清单清除")});var g={trid:"",valueStr:""};if(g.trid=b,f.UnitWish.length>0){for(var h="",j=0;j<f.UnitWish.length;j++)for(var k=0;k<f.UnitWish[j].children.length;k++)h+='("',h+=f.UnitWish[j].gid,h+='","',h+=f.UnitWish[j].children[k].cindex,h+='","',h+=f.UnitWish[j].children[k].cid,h+='","',h+=f.UnitWish[j].children[k].cname,h+='","',h+=f.UnitWish[j].children[k].amount,h+='","',h+=f.UnitWish[j].children[k].post_allocated_amount,h+='","',h+=f.UnitWish[j].children[k].allocated_value,h+='","',h+=b,h+='"),';h.length>0&&(g.valueStr=h.substring(0,h.length-1)),g.valueStr+="ON DUPLICATE KEY UPDATE post_allocated_amount = values(post_allocated_amount),post_allocated_value = values(post_allocated_value), amount=amount+values(amount)",e.writeResults(g,function(b){if(b.writeS){console.log("分券结果数据插入成功",b.writeS),i(c),a.currentSelectTid=c;var d={gid:a.currentSelectTid};e.getTname(d,function(b){a.currentSelectTidName=b.title,$(".js_tid").text(a.currentSelectTidName)}),e.randomOver(d,function(a){a.randomOverFlag?(console.log("该轮分券完毕，总券还有剩余，可继续进行下一轮分券"),csp.notify("notice",{msg:"该轮分券完毕，总券还有剩余，可继续进行下一轮分券",delay:15e3})):(console.log("该单元总券已全部分配完。您可点击小组查看最终分券结果。"),csp.notify("notice",{msg:"该单元总券已全部分配完。您可点击小组查看最终分券结果。",delay:15e3}))})}})}}})}else jQuery(".js-choose-random-trid").modal("show")}function g(a,b){jQuery("."+a).modal(b)}function h(a,b){var c;return!isNaN(parseFloat(a))&&isFinite(a)?(a=Number(a),a=("undefined"!=typeof b?a.toFixed(b):a).toString(),c=a.split("."),c[0]=c[0].toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"),c.join(".")):NaN}function i(b){var c={gid:""};c.gid=b,e.getRandmR(c,function(b){a.randmR=b,jQuery(".js-random-output").attr("disabled",!1),console.log("显示当前tid的分券结果信息",c.gid),e.getTname(c,function(b){a.currentSelectTidName=b.title,$(".js_tid").text(a.currentSelectTidName)}),e.getInfobyGid(c,function(a){$(".js-tid-bp").html(" 小组杠杆bp:"+h(a.t_bp,2)),$(".js-tid-allocated-value").html("分券市值:"+h(a.t_allocated_bp,2))})})}a.currentSelectTrid="",a.currentSelectTridName="",a.currentSelectTid=0,a.currentSelectTidName="",a.randomInit=function(){document.getElementById("csp_header_containter").style.display="none",document.getElementById("csp_footer").style.display="none",document.getElementById("homeSpaceDiv_37px").style.display="none",window.scrollTo(0,0)},$(document).ready(function(){var b={maid:""};b.maid=1,d.getModel(b,function(b){a.model=b,a.model.length>5?a.isActive=!0:a.isActive=!1,$(".js-trid").dropdown({onChange:function(b,c,d){a.$apply(function(){a.currentSelectTrid=b.split("(")[1].replace(")",""),a.currentSelectTridName=b})},on:"hover"})})}),a.$watch("currentSelectTrid",function(){if(console.log("$scope.currentSelectTrid",a.currentSelectTrid),a.currentSelectTrid){var b={trid:""};b.trid=a.currentSelectTrid,c.getTidModel(b,function(b){a.tidModel=b,0==b.length?(a.currentSelectTid="",a.currentSelectTidName="单元小组",$(".js_tid").text(a.currentSelectTidName)):(b.length>5?a.isTidActive=!0:a.isTidActive=!1,$(".js-tid").dropdown({onChange:function(b,c,d){a.$apply(function(){console.log(b),a.currentSelectTid=b.split("(")[1].split(")")[0],console.log("$scope.currentSelectTid",a.currentSelectTid)})},on:"hover"}))})}}),a.$watch("currentSelectTid",function(){if(a.currentSelectTid){i(a.currentSelectTid);var b={gid:a.currentSelectTid};e.getTname(b,function(b){a.currentSelectTidName=b.title,$(".js_tid").text(a.currentSelectTidName)})}}),a.randomDivOnBtn=function(){a.currentSelectTrid?jQuery(".js-random-allocated-comfirm").modal("show"):jQuery(".js-choose-random-trid").modal("show")},a.randomAllocatedConfirm=function(){g("js-random-allocated-comfirm","hide");var b={trid:""};b.trid=a.currentSelectTrid,e.getWishTid(b,function(b){"undefined"!=typeof b[0]?(a.currentSelectTid=b[0].gid,f(a.currentSelectTrid,a.currentSelectTid),$(".js-wait-random-div").addClass("active"),setTimeout(function(){$(".js-wait-random-div").removeClass("active")},3e3)):(csp.notify("notice",{msg:"该小组无人有心愿清单，无从分券",delay:5e3}),console.log("该小组无人有心愿清单，无从分券"))})},a.clearRandom=function(){a.currentSelectTrid?jQuery(".js-clear-random").modal("show"):jQuery(".js-choose-clear-trid").modal("show")},a.clearTrid=function(){var b={maid:"",trid:""};b.maid="1",b.trid=a.currentSelectTrid,e.recoverStock(b,function(a){a.recoverStock?console.log("总券剩余数量恢复了"):console.log("总券剩余数量恢复出错")}),e.deleResults(b,function(b){b.deleteR&&(i(-1),a.currentSelectTidName="单元小组",$(".js_tid").text(a.currentSelectTidName),console.log("清零成功，可以重新分券啦～"),csp.notify("notice",{msg:"清零成功，可以重新分券啦～",delay:5e3}))})},a.noWishGo=function(){console.log("是否有小组没有心愿清单--->get");var b={trid:""};b.trid=a.currentSelectTrid,e.noWishList(b,function(b){console.log("0为全有心愿清单，1为有人没有心愿清单",b.noWish),1==b.noWish?jQuery(".js-someone-no-wishlist").modal("show"):b.noWish==-1?jQuery(".js-all-no-wish").modal("show"):a.randomAllocatedConfirm()})},a.randomOutput=function(){if(a.currentSelectTid){var b=a.currentSelectTid,c="/random/exportExcel/"+b;window.location=c}else csp.notify("notice",{msg:"请选择导出的小组",delay:5e3})}}),cspCtrls.controller("tradeTeamManageCtrl",function(a,b,c){a.currentSelectTrid="",a.currentTridTeam="",a.currentSelectTridName="",a.editGid="",a.delGid="",a.tridUnitHeaverBp=0,a.tridUnitValue=0,a.selectedTraders=[],a.selectedLead=[],a.teamName="",a.status=0,a.allocateStockCtrlInit=function(){document.getElementById("csp_header_containter").style.display="none",document.getElementById("csp_footer").style.display="none",document.getElementById("homeSpaceDiv_37px").style.display="none",window.scrollTo(0,0)},$(document).ready(function(){a.cspTradeTeamManageLoadPath="tpls/allocateStock/tradeTeamManage.html",a.status=0}),a.cspTradeTeamManageLoadReady=function(){if(a.status){if(1==a.status){var b={maid:""};b.maid=1,c.getModel(b,function(b){a.model=b,$(".js-trid-add-new-team").dropdown({onChange:function(b,c,d){a.$apply(function(){a.currentTridTeam=b.split("(")[1].replace(")","")}),console.log("trid-changed:",b),console.log("$scope.currentTridTeam:",a.currentTridTeam)},on:"hover"})})}}else{var b={maid:""};b.maid=1,a.editGid="",a.currentSelectTrid&&$(".js_trid").text(a.currentSelectTridName),c.getModel(b,function(b){a.model=b,$(".js-trid").dropdown({onChange:function(b,c,d){a.$apply(function(){a.currentSelectTrid=b.split("(")[1].replace(")",""),a.currentSelectTridName=b}),console.log("trid-changed:",b),console.log("$scope.currentSelectTrid:",a.currentSelectTrid)},on:"hover"}),console.log("99999",b)})}},a.refreshTeam=function(){a.currentSelectTrid&&(jQuery(".js-update-view").addClass("active"),setTimeout(a.teamsInfo(),1e3))},a.addNewTeam=function(){a.currentTridTeam="",a.selectedTraders=[],a.selectedLead=[],a.cspTradeTeamManageLoadPath="tpls/allocateStock/addNewTeam.html",a.status=1},a.editTeam=function(b,c){var b=b,c=c;a.editGid=b,console.log("uuuuuuuuuu",b,c),a.teamName=c,a.cspTradeTeamManageLoadPath="tpls/allocateStock/editTeam.html",a.status=3,a.getTradersForEdit(a.currentSelectTrid,b)},a.getTradersNotInTeams=function(){if(console.log("$scope.currentTridTeam",a.currentTridTeam),a.currentTridTeam){var b={trid:""};b.trid=a.currentTridTeam,console.log("$scope.currentTridTeambbbbb",a.currentTridTeam),c.getTradersNotInTeams(b,function(b){a.traders=b,jQuery(".js-update-view").removeClass("active"),console.log("99999",b)})}},a.getTradersForEdit=function(b,d){if(a.selectedTraders=[],a.selectedLead=[],b){var e={trid:"",gid:""};e.trid=b,e.gid=d,c.getTradersForEdit(e,function(b){a.traders=b;var d={gid:""};d.gid=e.gid,c.getTeamTraders(d,function(b){for(var c=0;c<b.length;c++)a.selectedTraders.push(b[c].traderid),1==b[c].leader&&a.selectedLead.push(b[c].traderid)})})}},a.teamsInfo=function(){if(console.log("$scope.currentSelectTrid",a.currentSelectTrid),jQuery(".js-update-view").removeClass("active"),a.currentSelectTrid){var b={trid:""};b.trid=a.currentSelectTrid,c.teamsInfo(b,function(b){a.teams=b,a.tridUnitHeaverBp=0;for(var c=0;c<b.length;c++)a.tridUnitHeaverBp=a.tridUnitHeaverBp+b[c].bp_max;console.log("99999",b)})}},a.$watch("currentTridTeam",function(){a.selectedTraders=[],a.selectedLead=[],a.teamName="",a.getTradersNotInTeams()}),a.$watch("currentSelectTrid",function(){a.selectedTraders=[],a.selectedLead=[],a.teamName="",a.teamsInfo()}),a.isChecked=function(b){return a.selectedTraders.indexOf(b)>=0},a.updateSelection=function(b,c){var d=b.target,e=d.checked;if(e)a.selectedTraders.push(c);else{var f=a.selectedTraders.indexOf(c);a.selectedTraders.splice(f,1)}},a.isLeaderChecked=function(b){return a.selectedLead.indexOf(b)>=0},a.updateSelectionLeader=function(b,c){var d=b.target,e=d.checked;if(e)a.selectedLead.push(c);else{var f=a.selectedLead.indexOf(c);a.selectedLead.splice(f,1)}},a.noCreateandBack=function(){a.currentTridTeam="",a.selectedTraders=[],a.selectedLead=[],a.cspTradeTeamManageLoadPath="tpls/allocateStock/tradeTeamManage.html",a.status=0},a.editTeamConfirm=function(b){if(console.log("teamName",b),b)if(a.selectedTraders.length)if(a.selectedLead.length)if(a.selectedLead.length>1)$(".creat_team_tips").css("display","block"),a.creatTeamTips="每个小组只能选一人为小组组长",setTimeout(function(){a.creatTeamTips="",$(".creat_team_tips").css("display","none")},1e3);else if(a.selectedTraders.indexOf(a.selectedLead[0])<0)$(".creat_team_tips").css("display","block"),a.creatTeamTips="小组组长只能在小组成员中选择",setTimeout(function(){a.creatTeamTips="",$(".creat_team_tips").css("display","none")},1e3);else{var d={trid:"",gname:"",gid:"",traderid:[],leaderid:[],traderLength:""};d.trid=a.currentSelectTrid,d.gname=b,d.gid=a.editGid,d.traderid=a.selectedTraders,d.leaderid=a.selectedLead,d.traderLength=a.selectedTraders.length,c.editTeamConfirm(d,function(b){$(".creat_team_tips").css("display","block"),a.creatTeamTips="编辑小组成功.重新编辑小组或通过取消按钮返回",setTimeout(function(){a.creatTeamTips="",$(".creat_team_tips").css("display","none")},5e3)})}else $(".creat_team_tips").css("display","block"),a.creatTeamTips="请为该小组选择组长",setTimeout(function(){a.creatTeamTips="",$(".creat_team_tips").css("display","none")},1e3);else $(".creat_team_tips").css("display","block"),a.creatTeamTips="请选择小组成员",setTimeout(function(){a.creatTeamTips="",$(".creat_team_tips").css("display","none")},1e3);else $(".creat_team_tips").css("display","block"),a.creatTeamTips="请输入小组名称",setTimeout(function(){a.creatTeamTips="",$(".creat_team_tips").css("display","none")},1e3)},a.createTeamConfirm=function(b){if(console.log("teamName",b),b)if(a.selectedTraders.length)if(a.selectedLead.length)if(a.selectedLead.length>1)$(".creat_team_tips").css("display","block"),a.creatTeamTips="每个小组只能选一人为小组组长",setTimeout(function(){a.creatTeamTips="",$(".creat_team_tips").css("display","none")},1e3);else if(a.selectedTraders.indexOf(a.selectedLead[0])<0)$(".creat_team_tips").css("display","block"),a.creatTeamTips="小组组长只能在小组成员中选择",setTimeout(function(){a.creatTeamTips="",$(".creat_team_tips").css("display","none")},1e3);else{var d={trid:"",gname:"",traderid:[],leaderid:[],traderLength:""};d.trid=a.currentTridTeam,d.gname=b,d.traderid=a.selectedTraders,d.leaderid=a.selectedLead,d.traderLength=a.selectedTraders.length,c.addNewTeam(d,function(b){a.selectedTraders=[],a.selectedLead=[],a.teamName="",a.getTradersNotInTeams(),$(".creat_team_tips").css("display","block"),a.creatTeamTips="新建小组成功.再新建一个小组或通过取消按钮返回",setTimeout(function(){a.creatTeamTips="",$(".creat_team_tips").css("display","none")},5e3)})}else $(".creat_team_tips").css("display","block"),a.creatTeamTips="请为该小组选择组长",setTimeout(function(){a.creatTeamTips="",$(".creat_team_tips").css("display","none")},1e3);else $(".creat_team_tips").css("display","block"),a.creatTeamTips="请选择小组成员",setTimeout(function(){a.creatTeamTips="",$(".creat_team_tips").css("display","none")},1e3);else $(".creat_team_tips").css("display","block"),a.creatTeamTips="请输入小组名称",setTimeout(function(){a.creatTeamTips="",$(".creat_team_tips").css("display","none")},1e3)},a.updateModalState=function(a,b){jQuery("."+a).modal(b)},a.delTeam=function(b){a.delGid=b,a.updateModalState("js-team-del-page","toggle")},a.delTeamConfirm=function(){var b={gid:""};b.gid=a.delGid,c.delGid(b,function(b){a.delGid=""})},a.teamDetail=function(b,c){var b=b,c=c;a.teamName=c,a.cspTradeTeamManageLoadPath="tpls/allocateStock/tradeTeamDetail.html",a.status=4,a.getTradersForEdit(a.currentSelectTrid,b)}}),cspCtrls.controller("unitManageCtrl",function(a,b,c,d,e,f){function g(b,c){if(1===b.type){for(var d=c;d>=0;d--)if(a.allUnits[d].maid<b.maid)return d+1;return 0}if(2===b.type){var e=b.caid.split(".");e=e[e.length-1],console.log("currID",e);for(var d=c;d>=0;d--)if("undefined"!=typeof a.allUnits[d].caid){var f=a.allUnits[d].caid.split(".");if(f=f[f.length-1],f<e)return d+1}else if(a.allUnits[d].maid===b.maid)return d+1;return 0}if(3===b.type){var e=b.trid.split(".");e=e[e.length-1],console.log("currID",e);for(var d=c;d>=0;d--)if("undefined"!=typeof a.allUnits[d].trid){var f=a.allUnits[d].trid.split(".");if(f=f[f.length-1],f<e)return d+1}else if(a.allUnits[d].caid===b.caid)return d+1;return 0}}a.assetManagers=[],a.allUnits=[],a.modalLoadPath="",a.allState=[{desc:"可用",stat:"0"},{desc:"冻结",stat:"1"}],a.selectState=a.allState[0],a.unitName="",a.currOperateUnit={},a.currSelecetedUnit={},a.unitManage=a,a.editingManager=!0,a.editingAssetUnit=!0,a.editingTradeUnit=!0,a.cookieinfo={},a.searchField="",$(document).ready(function(){document.getElementById("csp_header_containter").style.display="none",document.getElementById("csp_footer").style.display="none",document.getElementById("homeSpaceDiv_37px").style.display="none",document.getElementById("uiView").style.minHeight="100%",console.log("unitManageCtrl ready"),a.getAllAssetManagers()}),a.unitManageInit=function(){if(document.getElementById("csp_header_containter").style.display="none",document.getElementById("csp_footer").style.display="none",document.getElementById("homeSpaceDiv_37px").style.display="none",document.cookie||navigator.cookieEnabled){a.cookieinfo.exist=!1;for(var c="cspOperLoginInfo=",d=document.cookie.split(";"),e=0;e<d.length;e++){var g=d[e].trim();if(0==g.indexOf(c)){a.cookieinfo.cookieExist=!0;var h=JSON.parse(unescape(g.substring(c.length,g.length)));a.cookieinfo.login_maid=h.maid,a.cookieinfo.login_oid=h.oid,a.cookieinfo.login_pass=h.password;break}}console.log("开始自动登录"),f.cspOperCheckAndLogin(a.cookieinfo,function(a){"succeed"==a.result||b.go("operlogin")})}else alert("浏览器未开启cookie,网站可能无法正常使用"),b.go("operlogin")},a.showError=function(b){document.getElementById("errorReason").innerHTML=b,document.getElementById("errorMessage").style.display="",a.timeout&&c.cancel(a.timeout),a.timeout=c(function(){document.getElementById("errorMessage").style.display="none"},5e3)},a.getAllAssetManagers=function(){e.getAllAssetManagers("",function(b){if(0!=b.result){a.allUnits=b;for(var c=0;c<b.length;c++)b[c].id=b[c].maid,b[c].name=b[c].maname,b[c].type=1,b[c].haveData=!0,b[c].show=!0,b[c].showChild=!1;a.getAllAssetUnits()}})},a.getAllAssetUnits=function(){e.getAllAssetUnits("",function(b){if(b.result!==!1){a.allAssetUnits=b;for(var c=0,d=0;d<a.allUnits.length;d++){for(;c<b.length&&(b[c].id=b[c].caid,b[c].name=b[c].caname,b[c].type=2,b[c].haveData=!0,b[c].show=!1,b[c].showChild=!1,a.allUnits[d].maid===b[c].maid);c++)a.allUnits.splice(++d,0,b[c]);var e={};e.type=2,e.addAssetUnit=!0,e.maid=a.allUnits[d].maid,e.show=!1,a.allUnits.splice(++d,0,e)}a.getAllAssetTraders()}})},a.getAllAssetTraders=function(){e.getAllAssetTraders("",function(b){if(0!=b.result){a.allTraderUnits=b,console.log("getAllAssetTraders",b);for(var c=0,d=0;d<a.allUnits.length;d++){for(;c<b.length&&(b[c].id=b[c].trid,b[c].name=b[c].trname,b[c].type=3,b[c].haveData=!0,b[c].show=!1,b[c].showChild=!1,a.allUnits[d].maid===b[c].maid&&a.allUnits[d].caid===b[c].caid&&a.allUnits[d].addAssetUnit!==!0);c++)a.allUnits.splice(++d,0,b[c]);if("undefined"!=typeof a.allUnits[d].caid&&a.allUnits[d].addAssetUnit!==!0){var e={};e.type=3,e.addTradeUnit=!0,e.caid=a.allUnits[d].caid,e.maid=a.allUnits[d].maid,e.show=!1,a.allUnits.splice(++d,0,e)}}}})},a.getAssetUnitFromCapManager=function(b){for(var c=0;c<a.allUnits.length;c++)if(a.allUnits[c].maid==b){if(1==a.allUnits[c].showChild)for(var d=c+1;d<a.allUnits.length&&(a.allUnits[d].maid==b&&a.allUnits[d].type>1);d++)a.allUnits[d].showChild=!1,a.allUnits[d].show=!1;else for(var d=c+1;d<a.allUnits.length;d++)a.allUnits[d].maid==b&&2==a.allUnits[d].type&&(a.allUnits[d].show=!0);a.allUnits[c].showChild=!a.allUnits[c].showChild;break}},a.getTransUnitFromAssetUnit=function(b){for(var c=0;c<a.allUnits.length;c++)if(a.allUnits[c].caid==b){a.allUnits[c].showChild=!a.allUnits[c].showChild;for(var d=c+1;d<a.allUnits.length&&(a.allUnits[d].caid==b&&3==a.allUnits[d].type);d++)a.allUnits[d].show=!a.allUnits[d].show;break}},a.clickUnit=function(b){console.log("clickUnit",b),1==b.type?a.getAssetUnitFromCapManager(b.id):2==b.type?b.addAssetUnit?console.log("添加资产单元"):a.getTransUnitFromAssetUnit(b.id):3==b.type&&(b.addTradeUnit?console.log("添加交易单元"):console.log("点击交易单元"))},a.frozenAssetManager=function(b){var c={};c.maid=b,e.frozenAssetManager(c,function(c){if(0!=c.result)for(var d=0;d<a.allUnits.length;d++)if(1==a.allUnits[d].type&&a.allUnits[d].maid==b){a.allUnits[d].stat="1";break}})},a.frozenAssetUnit=function(b){var c={};c.caid=b,e.frozenAssetUnit(c,function(c){if(0!=c.result)for(var d=0;d<a.allUnits.length;d++)if(2==a.allUnits[d].type&&a.allUnits[d].caid==b){a.allUnits[d].stat="1";break}})},a.frozenTradeUnit=function(b){var c={};c.trid=b,e.frozenTradeUnit(c,function(c){if(0!=c.result)for(var d=0;d<a.allUnits.length;d++)if(3==a.allUnits[d].type&&a.allUnits[d].trid==b){a.allUnits[d].stat="1";break}})},a.unfreezeAssetManager=function(b){var c={};c.maid=b,console.log("unfreezeAssetManager",a.allUnits,b),e.unfreezeAssetManager(c,function(c){if(0!=c.result)for(var d=0;d<a.allUnits.length;d++)if(1==a.allUnits[d].type&&a.allUnits[d].maid==b){a.allUnits[d].stat="0";break}})},a.unfreezeAssetUnit=function(b){var c={};c.caid=b,e.unfreezeAssetUnit(c,function(c){if(0!=c.result)for(var d=0;d<a.allUnits.length;d++)if(2==a.allUnits[d].type&&a.allUnits[d].caid==b){a.allUnits[d].stat="0";break}})},a.unfreezeTradeUnit=function(b){var c={};c.trid=b,e.unfreezeTradeUnit(c,function(c){if(0!=c.result)for(var d=0;d<a.allUnits.length;d++)if(3==a.allUnits[d].type&&a.allUnits[d].trid==b){a.allUnits[d].stat="0";break}})},a.frozen=function(b){1==b.type?a.frozenAssetManager(b.maid):2==b.type?a.frozenAssetUnit(b.caid):3==b.type&&a.frozenTradeUnit(b.trid)},a.unfreeze=function(b){1==b.type?(console.log(b),a.unfreezeAssetManager(b.id)):2==b.type?a.unfreezeAssetUnit(b.id):3==b.type&&a.unfreezeTradeUnit(b.id)},a.addManager=function(){a.currOperateUnit.maid="",a.unitName="",a.editingManager=!1,a.currSelecetedUnit={},a.selectState=a.allState[0],a.modalLoadPath="tpls/unitManage/assetManager.html",$("#unitManageModal").modal("show")},a.addAssetUnit=function(b,c){console.log("addAssetUnit",b),a.currOperateUnit.maid=b.maid,a.currOperateUnit.caid="",a.unitName="",a.editingAssetUnit=!1,a.currSelecetedUnit=b,a.currSelecetedUnit.index=c,a.selectState=a.allState[0],a.modalLoadPath="tpls/unitManage/assetUnit.html",$("#unitManageModal").modal("show")},a.addTradeUnit=function(b,c){console.log("addTradeUnit",c),a.currOperateUnit.maid=b.maid,a.currOperateUnit.caid=b.caid,a.currOperateUnit.trid="",a.unitName="",a.editingTradeUnit=!1,a.currSelecetedUnit=b,a.currSelecetedUnit.index=c,a.selectState=a.allState[0],a.modalLoadPath="tpls/unitManage/tradeUnit.html",$("#unitManageModal").modal("show")},a.editUnit=function(b){a.currSelecetedUnit=b,$.extend(a.currOperateUnit,a.currSelecetedUnit),a.unitName=a.currSelecetedUnit.name;var c=parseInt(a.currSelecetedUnit.stat);switch(a.selectState=a.allState[c],console.log(c,a.selectState,a.allState),b.type){case 1:a.editingManager=!0,a.modalLoadPath="tpls/unitManage/assetManager.html";break;case 2:a.editingAssetUnit=!0,a.modalLoadPath="tpls/unitManage/assetUnit.html";break;case 3:a.editingTradeUnit=!0,a.modalLoadPath="tpls/unitManage/tradeUnit.html"}$("#unitManageModal").modal("show")},a.saveOperateManager=function(b){var c=/^\d+$/;if(!c.test(a.currOperateUnit.maid))return void a.showError("资产管理人id必须全为数字");if(""==a.unitName)return void a.showError("名称不能为空");if(a.currOperateUnit.maid<1)return void a.showError("单元编号必须大于0");var d={};d.stat=b.stat,d.maname=a.unitName,d.maid=a.currOperateUnit.maid,a.editingManager?(d.maid=a.currSelecetedUnit.maid,e.saveEditAssetManager(d,function(b){return 0==b.result?void a.showError(b.reason):(a.currSelecetedUnit.stat=d.stat,a.currSelecetedUnit.maname=a.unitName,a.currSelecetedUnit.name=a.unitName,void $("#unitManageModal").modal("hide"))})):e.createAssetManager(d,function(b){if(0==b.result)return void a.showError(b.reason);var c={};c.id=b.maid,c.maid=b.maid,c.stat=d.stat,c.type=1,c.name=d.maname,c.show=!0,c.showChild=!1;var e={};e.type=2,e.addAssetUnit=!0,e.maid=b.maid,e.show=!1;var f=g(c,a.allUnits.length-1);a.allUnits.splice(f,0,c,e),$("#unitManageModal").modal("hide"),console.log("createAssetManager success",d,a.unitName)})},a.cancelOperatedManager=function(){if(a.editingManager){a.unitName=a.currSelecetedUnit.name;var b=parseInt(a.currSelecetedUnit.stat);a.selectState=a.allState[b],console.log(a.selectState,a.allState,a.currSelecetedUnit.stat,b)}else a.unitName="",a.selectState=a.allState[0],console.log(a.selectState,a.allState)},a.saveOperateAssetUnit=function(b){var c=/^\d+$/;if(!c.test(a.currOperateUnit.caid))return void a.showError("资产单元id必须全为数字");if(""==a.unitName)return void a.showError("名称不能为空");if(a.currOperateUnit.caid<1)return void a.showError("单元编号必须大于0");var d={};d.stat=b.stat,d.caname=a.unitName,d.maid=a.currOperateUnit.maid,d.caid=a.currOperateUnit.maid+"."+a.currOperateUnit.caid,a.editingAssetUnit?e.saveEditAssetUnit(d,function(b){return 0==b.result?void a.showError(b.reason):(a.currSelecetedUnit.stat=d.stat,a.currSelecetedUnit.caname=a.unitName,a.currSelecetedUnit.name=a.unitName,void $("#unitManageModal").modal("hide"))}):(console.log(d),e.createAssetUnit(d,function(b){if(0==b.result)return void a.showError(b.reason);var c={};c.id=b.caid,c.maid=b.maid,c.caid=b.caid,c.stat=d.stat,c.type=2,c.name=d.caname,c.caname=d.caname,c.show=!0,c.showChild=!1;var e={};e.type=3,e.addTradeUnit=!0,
e.maid=b.maid,e.caid=b.caid,e.show=!1;var f=g(c,a.currSelecetedUnit.index-1);console.log("index",f),a.allUnits.splice(f,0,c,e),$("#unitManageModal").modal("hide"),console.log("createAssetManager success",d,a.unitName)}))},a.cancelOperatedAssetUnit=function(){if(a.editingManager){a.unitName=a.currSelecetedUnit.name;var b=parseInt(a.currSelecetedUnit.stat);a.selectState=a.allState[b],console.log(a.selectState,a.allState,a.currSelecetedUnit.stat,b)}else a.unitName="",a.selectState=a.allState[0],console.log(a.selectState,a.allState)},a.saveOperateTradeUnit=function(b){var c=/^\d+$/;if(!c.test(a.currOperateUnit.trid))return void a.showError("交易单元id必须全为数字");if(""==a.unitName)return void a.showError("名称不能为空");if(a.currOperateUnit.trid<1)return void a.showError("单元编号必须大于0");var d={};d.stat=b.stat,d.trname=a.unitName,d.maid=a.currOperateUnit.maid,d.caid=a.currOperateUnit.caid,d.trid=a.currOperateUnit.caid+"."+a.currOperateUnit.trid,console.log(d),a.editingTradeUnit?e.saveEditTradeUnit(d,function(b){return 0==b.result?void a.showError(b.reason):(a.currSelecetedUnit.stat=d.stat,a.currSelecetedUnit.trname=a.unitName,a.currSelecetedUnit.name=a.unitName,void $("#unitManageModal").modal("hide"))}):e.createTradeUnit(d,function(b){if(0==b.result)return void a.showError(b.reason);var c={};c.id=b.trid,c.maid=d.maid,c.caid=d.caid,c.trid=d.trid,c.stat=d.stat,c.type=3,c.name=d.trname,c.trname=d.trname,c.show=!0,c.showChild=!1;var e=g(c,a.currSelecetedUnit.index-1);console.log("index",e,a.currSelecetedUnit.index),a.allUnits.splice(e,0,c),$("#unitManageModal").modal("hide"),console.log("createAssetManager success",d,a.unitName)})},a.cancelOperated=function(){document.getElementById("errorMessage").style.display="none",a.modalLoadPath="",a.editingManager=!0,a.editingAssetUnit=!0,a.editingTradeUnit=!0,$("#unitManageModal").modal("hide")},a.enterSearch=function(b){var c=window.event?b.keyCode:b.which;if(""==a.searchField)for(var d=0;d<a.allUnits.length;d++)a.allUnits[d].find=!1;if(13===c){console.log("enterSearch");for(var d=0;d<a.allUnits.length;d++)if(!a.allUnits[d].addAssetUnit&&!a.allUnits[d].addTradeUnit){var e=a.allUnits[d].id.toLowerCase();e.indexOf(a.searchField)===-1?(e=a.allUnits[d].name.toLowerCase(),e.indexOf(a.searchField)!==-1&&(a.allUnits[d].find=!0)):a.allUnits[d].find=!0}}},a.refresh=function(){a.getAllAssetManagers(),a.searchField=""}}),cspCtrls.controller("wishListCtrl",function(a,b,c,d,c){function e(){this.stockIndex="",this.stockNo="",this.stockName="",this.stockNum="",this.marketVal=""}a.currentSelectTrid="",a.currentSelectTridName="",a.currentSelectTid=0,a.currentSelectTidName="";var f="",g=!1;a.surplusBp=0,a.marketPrice=0,a.BPvalue=0,a.wishListCtrlInit=function(){document.getElementById("csp_header_containter").style.display="none",document.getElementById("csp_footer").style.display="none",document.getElementById("homeSpaceDiv_37px").style.display="none",window.scrollTo(0,0)},$(document).ready(function(){var b={maid:""};b.maid=1,d.getModel(b,function(b){a.model=b,$(".js-trid").dropdown({onChange:function(b,c,d){a.$apply(function(){a.currentSelectTrid=b.split("(")[1].replace(")",""),a.currentSelectTridName=b})},on:"hover"})}),a.tableOperator(),$(".js-table-container,.group-wish-list-table").droppable({drop:function(b,c){if(console.log("drapingId-------------",f),void 0!==f&&""!==f&&null!==f&&g){console.log("isAddrow",g);var d=$("#left"+f);console.log("leftRowObj------",d);var e=$("#right"+f);if(e.length>0)return console.log("exist"),void csp.notify("notice",{msg:"该股票已存在于心愿清单，可进行数量更改或删除操作",delay:5e3});var h=$(".js-surplusBp-value").text().split(":")[1];a.surplusBP=a.unformat(h),console.log(a.surplusBP,h);var i=a.calCurMarketValue(f,100,a.surplusBP),j=a.calCurUnitAmount(f,100);if(i){var k=0,l=$(d).children();k=j?100:$(l[5]).html();var m=$(l[1]).html(),n=$(l[2]).html(),o=a.formatNumber(100*a.calStockUnitPrice(m.split(".")[0]),2),p="right"+f,q='<tr class="js-right-row" id="'+p+'"><td>0</td><td>'+m+"</td><td>"+n+'</td><td class="js-amount-right"><div class="ui icon input js-stock-num"><input type="text" value="'+k+'" ><div class="js-num-change"><i class="caret up link icon"></i><i class="caret down link icon"></i></div></div></td><td class="js-num-right">'+o+'</td><td><i class="trash outline big link icon" data-content="移除"></i></td></tr>',r=$(this).children(),s=r[0],t=$(s).children(),u=t[0],v=t[1],w=$(u).next().children();w.length>0?$(v).append(q):$(u).next().append(q),a.updateCurMaketValue()}else csp.notify("notice",{msg:"超出剩余杠杆BP,无法添加进心愿清单",delay:5e3})}a.tableOperator(),a.dealRightTableNo()}})}),a.$watch("currentSelectTrid",function(){if(console.log("$scope.currentSelectTrid",a.currentSelectTrid),a.currentSelectTrid){var b={trid:""};b.trid=a.currentSelectTrid,a.refreshUnitStocks(a.currentSelectTrid),c.getTidModel(b,function(b){a.tidModel=b,0==b.length?(a.currentSelectTid="",a.currentSelectTidName="交易单元小组",$(".js_tid").text(a.currentSelectTidName)):$(".js-tid").dropdown({onChange:function(b,c,d){a.$apply(function(){console.log(b),a.currentSelectTid=b.split("(")[1].split(")")[0],console.log("$scope.currentSelectTid",a.currentSelectTid)})},on:"hover"})})}}),a.$watch("currentSelectTid",function(){a.currentSelectTid&&(a.refreshBP(a.currentSelectTid),a.refreshGroupWish(a.currentSelectTrid,a.currentSelectTid))}),a.clearTable=function(a){try{for(var b=document.getElementById(a),c=b.getElementsByTagName("tr"),d=c.length-1;d>0;d--)b.deleteRow(d)}catch(a){}},a.dragLeftTable=function(){$(".js-left-table").draggable({cursor:"move",cursorAt:{top:-2,left:-2},helper:"clone",start:function(){var a=$(this).children(),b=$(a[1]).html();f=b.split(".")[0],g=!0}})},a.refreshUnitStocks=function(b){var d={trid:""};d.trid=b,c.getUnitStocks(d,function(b){if(a.clearTable("left-table"),b.length>=0){for(var c="",d=0;d<b.length;d++){var e=d+1,f=b[d].cid,g=b[d].cname,h=a.formatNumber(b[d].totalsa),i="left"+b[d].cid.split(".")[0],j=a.formatNumber(b[d].preclose,2),k=a.formatNumber(b[d].totalsa-b[d].allocatedsa),l=a.formatNumber((b[d].totalsa-b[d].allocatedsa)*b[d].preclose,2),m='<tr class="js-left-table ui-widget-content" id="'+i+'"><td>'+e+"</td><td>"+f+"</td><td>"+g+'</td><td class="js-num-left">'+h+'</td><td class="js-num-left">'+j+'</td><td class="js-num-left">'+k+'</td><td class="js-num-left">'+l+"</td></tr>";c+=m}c.length>0&&($(".js-left-tbody").append(c),a.dragLeftTable())}$(".groupWish-view").removeClass("active")})},a.formatNumber=function(a,b){var c;return!isNaN(parseFloat(a))&&isFinite(a)?(a=Number(a),a=("undefined"!=typeof b?a.toFixed(b):a).toString(),c=a.split("."),c[0]=c[0].toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"),c.join(".")):NaN},a.unformat=function(a){var b=a.split(","),c=+b.join("");return c},a.updateCurMaketValue=function(){for(var b=0,c=$(".js-right-table").children(),d=0;d<c.length;d++){var e=$(c[d]).children(),f=e[4],g=a.unformat($(f).text());b+=parseFloat(g);var h=e[2];$(h).text()}a.marketPrice=b.toFixed(2);var i="市值:"+a.formatNumber(b,2);$(".js-market-value").html(i)},a.calStockUnitAmount=function(b){var c=$("#left"+b),d=$(c).children(),e=a.unformat($(d[5]).text());return e},a.calCurUnitAmount=function(b,c){var d=!1,e=a.calStockUnitAmount(b);return d=!(c>e)},a.calStockUnitPrice=function(b){var c=$("#left"+b),d=$(c).children(),e=a.unformat($(d[4]).text());return e},a.calCurMarketValue=function(b,c,d){for(var e=!1,f=a.calStockUnitPrice(b),g=0,h=$(".js-right-table").children(),i=0;i<h.length;i++){var j=$(h[i]).children();if(console.log("rows[1].text()",$(j[1]).text()),b!==$(j[1]).text().split(".")[0]){var k=j[4],l=a.unformat($(k).text());g+=parseFloat(l)}}return console.log(g,c,f,d),e=!(g+c*f>d)},a.dealRightTableNo=function(){for(var a=$(".js-right-table").children(),b=0;b<a.length;b++){var c=$(a[b]).children(),d=c[0];$(d).text(b+1)}},a.delayInputDeal=function(b){var c=$(b).val(),d=$(b).attr("value");if(/^\d+$/.test(c)){var e=c.replace(/\D/g,"");$(b).val(e);var f=$(b).parent().parent().prev().prev().text(),g=e,h=$(".js-surplusBp-value").text().split(":")[1];a.surplusBP=a.unformat(h);var i=a.calCurUnitAmount(f.split(".")[0],parseInt(g));if(i){var j=a.calCurMarketValue(f.split(".")[0],parseInt(g),a.surplusBP);j?$(b).attr("value",e):($(b).val(d),csp.notify("notice",{msg:"超出剩余杠杆BP，请重新确认数量",delay:5e3}),console.log("超出剩余杠杆BP_input"))}else $(b).val(d),csp.notify("notice",{msg:"超出券表中该支证券数量,请重新确认数量",delay:5e3}),console.log("超出券表中该支证券数量");var k=a.calStockUnitPrice(f.split(".")[0]);g=$(b).val();var l=a.formatNumber(g*k,2);$(b).parent().parent().next().html(l),a.updateCurMaketValue()}else $(b).val(d),csp.notify("notice",{msg:"请输入正确格式数量",delay:5e3})},a.tableOperator=function(){a.dragLeftTable(),$(".js-right-row").draggable({cursor:"move",cursorAt:{top:-2,left:-2},helper:"clone",start:function(){var a=$(this).children(),b=$(a[1]).html();f=b.split(".")[0],g=!1}}),$(".caret.up.link").unbind("click").click(function(){var b=$(this).parent().prev().val();null!=b&&void 0!=b&&""!=b||(b="0");var c=$(this).parent().parent().parent().prev().prev().html(),d=$(this).parent().prev().val();console.log("curNumStr",b),console.log("stockNo",c),console.log("stockInput",d);var e=$(".js-surplusBp-value").text().split(":")[1];a.surplusBP=a.unformat(e),console.log("input",a.surplusBP,e);var f=a.calCurMarketValue(c.split(".")[0],parseInt(d)+100,a.surplusBP),g=a.calCurUnitAmount(c.split(".")[0],parseInt(d)+100);if(g)if(f){var h=0;h=parseInt(b)+100,$(this).parent().prev().val(h),$(this).parent().prev().attr("value",h);var i=a.calStockUnitPrice(c.split(".")[0]),j=a.formatNumber(h*i,2);$(this).parent().parent().parent().next().html(j)}else csp.notify("notice",{msg:"超出剩余杠杆BP，请重新确认心愿清单",delay:5e3}),console.log("数量增加失败-->",c);else csp.notify("notice",{msg:"超出券表中该支证券数量,请重新确认数量",delay:5e3}),console.log("超出券表中该支证券数量");a.updateCurMaketValue()}),$(".caret.down.link").unbind("click").click(function(){var b=$(this).parent().parent().parent().prev().prev().html(),c=$(this).parent().prev().val(),d=0;if(d=parseInt(c)-100,d>=0){$(this).parent().prev().val(d),$(this).parent().prev().attr("value",d);var e=a.calStockUnitPrice(b.split(".")[0]),f=a.formatNumber(d*e,2);$(this).parent().parent().parent().next().html(f)}else d>=-100&&($(this).parent().prev().val(0),$(this).parent().prev().attr("value",0),$(this).parent().parent().parent().next().html(formatNumber(0,2)));a.updateCurMaketValue()}),$("input").focus(function(){var b=this,c=$(b);c.attr("value");c.off("keyup").on("keyup",function(a){"13"==a.keyCode&&c.blur()}),c.unbind("blur").blur(function(){a.delayInputDeal(b)})}),$(".input").on("mouseenter mouseleave",function(a){$(this);"mouseenter"==a.type?$(this).children(".js-num-change").show():"mouseleave"==a.type&&$(this).children(".js-num-change").hide()}),$(".trash, .outline").on("click",function(){$(this).parent().parent().remove(),a.dealRightTableNo(),a.updateCurMaketValue()}),$(".js-right-row").droppable({accept:".js-right-row ",drop:function(b,c){if(void 0!==f&&""!==f&&null!==f){var d=$("#right"+f),e=($(d).html(),$(d).children()),g=$(e[1]).html(),h=$(e[2]).html(),i=$(e[3]).children(),j=$(i[0]).children(),k=$(j[0]).val(),l=$(e[4]).html(),m="right"+f,n='<tr class="js-right-row" id="'+m+'"><td>0</td><td>'+g+"</td><td>"+h+'</td><td class="js-amount-right"><div class="ui icon input js-stock-num"><input type="text" value="'+k+'" ><div class="js-num-change"><i class="caret up link icon"></i><i class="caret down link icon"></i></div></div></td><td class="js-num-right">'+l+'</td><td><i class="trash outline big link icon" data-content="移除"></i></td></tr>',o=this,p=$(o),q=$(p).attr("id");if(console.log("----->",q),console.log("--->","right"+f),void 0==q||""==q||null==q||q==="right"+f)return;$(o).before(n),$(d).remove(),a.tableOperator(),a.dealRightTableNo()}}})},a.saveWishLists=function(){var b=$(".js-surplusBp-value").text().split(":")[1],d=a.unformat(b);if(console.log("hhhhhh",b,d),0===a.currentSelectTid)csp.notify("notice",{msg:"请先选择小组",delay:5e3});else if(a.marketPrice-d>0)console.log(a.marketPrice,d),csp.notify("notice",{msg:"心愿清单市值超过剩余杠杆BP值，不能进行该操作",delay:5e3});else{for(var f=new Array,g="",h=new Date,i=$(".js-right-table").children(),j=0;j<i.length;j++){var k=new e,l=$(i[j]).children();k.stockIndex=$(l[0]).text(),k.stockNo=$(l[1]).text(),k.stockName=$(l[2]).text();var m=$(l[3]).children(),n=$(m[0]).children(),o=$(n[0]),p=a.calStockUnitAmount(k.stockNo.split(".")[0]);if(k.stockNum=$(o).val(),p<k.stockNum)return void csp.notify("notice",{msg:"心愿清单中存在证券数量超过券表中其对应数量的",delay:5e3});console.log("stockNumObj--->",k.stockNum),f.push(k)}if(f.length>0){for(var q="",j=0;j<f.length;j++)q+='("',q+=f[j].stockIndex,q+='","',q+=f[j].stockNo,q+='","',q+=f[j].stockName,q+='","',q+=f[j].stockNum,q+='","',q+=h,q+='","',q+=a.currentSelectTid,q+='","',q+=a.currentSelectTrid,q+='"),';q.length>0&&(g=q.substring(0,q.length-1))}var r={valueStr:"",gid:""};r.valueStr=g,r.gid=a.currentSelectTid,c.submitWishList(r,function(a){csp.notify("notice",{msg:"保存成功",delay:5e3})})}},a.refreshBP=function(b){console.log("curBP tid-->",b);var d={gid:""};d.gid=b,c.getGroupBpValue(d,function(b){var c=b.bpData,d=b.surplusHeaverBP;a.BPvalue=parseFloat(c).toFixed(2),a.surplusBP=parseFloat(d).toFixed(2),console.log("获取BP值成功",a.surplusBP),$(".js-bp-value").html("BP:"+a.formatNumber(a.BPvalue,2)),$(".js-surplusBp-value").html("剩余杠杆BP:"+a.formatNumber(a.surplusBP,2))})},a.refreshGroupWish=function(b,d){var e={gid:"",trid:""};e.gid=d,e.trid=b,c.getGroupWishList(e,function(b){var c=b.groupWishListdata;if(a.clearTable("right-table"),c.length>=0){for(var d="",e=0;e<c.length;e++){var f=c[e].cid,g=c[e].cname,h=c[e].amount,i=c[e].cindex,j=a.formatNumber(h*c[e].preclose,2),k="right"+c[e].cid.split(".")[0],l='<tr class="js-right-row" id="'+k+'"><td>'+i+"</td><td>"+f+"</td><td>"+g+'</td><td class="js-amount-right"><div class="ui icon input js-stock-num"><input type="text" value="'+h+'" ><div class="js-num-change"><i class="caret up link icon"></i><i class="caret down link icon"></i></div></div></td><td class="js-num-right">'+j+'</td><td><i class="trash outline big link icon" data-content="移除"></i></td></tr>';d+=l}d.length>0&&($(".js-right-table").append(d),a.tableOperator()),$(".groupWish-view").removeClass("active")}a.updateCurMaketValue()})}});var cspFilters=angular.module("cspFilters",[]);cspFilters.filter("",function(){}),Date.prototype.Format=function(a){var b={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var c in b)new RegExp("("+c+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?b[c]:("00"+b[c]).substr((""+b[c]).length)));return a};var getMaxAndInterval=function(a){var b=5,c=a/b,d=c,e=0;if(c<1)for(var e=1;c<1;)c=10*c,e-=1;else for(;c>=1;)c/=10,e+=1;console.log("n",e),d=Math.ceil(d/Math.pow(10,e-1))*Math.pow(10,e-1),e=Math.abs(e)+1<=20?Math.abs(e)+1:20,d=parseFloat(d.toFixed(e)),a>=d*b-.5*d?(a=d*(b+1),b+=1):a=d*b,a=parseFloat(a.toFixed(e));var f={};return f.max=a,f.interval=d,f},cspRouters=angular.module("cspRouters",["ui.router"]);cspRouters.config(function(a,b){b.otherwise("/operlogin"),a.state("operlogin",{url:"/operlogin",views:{"":{templateUrl:"tpls/securitiesManage/operLogin.html"}}}).state("allocateStock",{url:"/allocateStock",views:{"":{templateUrl:"tpls/allocateStock/index.html"}}}).state("tradeTeamManage",{url:"/tradeTeamManage",views:{"":{templateUrl:"tpls/allocateStock/tradeTeamManageIndex.html"}}}).state("opermanage",{url:"/opermanage",views:{"":{templateUrl:"tpls/operManage/index.html"}}}).state("layoutmanage",{url:"/layoutmanage",views:{"":{templateUrl:"tpls/layoutmanage/index.html"}}}).state("unitManage",{url:"/unitManage",views:{"":{templateUrl:"tpls/unitManage/index.html"}}}).state("wishList",{url:"/wishList",views:{"":{templateUrl:"tpls/wishList/index.html"}}}).state("groupexchange",{url:"/groupexchange",views:{"":{templateUrl:"tpls/groupexchange/index.html"}}}).state("random",{url:"/random",views:{"":{templateUrl:"tpls/random/index.html"}}}).state("importStockData",{url:"/importStockData",views:{"":{templateUrl:"tpls/importStockData/index.html"}}}).state("operloginout",{url:"/operloginout",views:{"":{templateUrl:"tpls/operloginout/index.html"}}})});var cspServices=angular.module("cspServices",[]);cspServices.factory("allocateStockService",function(a){var b={};return b.getModel=function(b,c){a({url:"/tradeTeamManage/getModel",params:b,method:"GET"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取交易单元失败",c(b)})},b.getTradersNotInTeams=function(b,c){a({url:"/tradeTeamManage/getTradersNotInTeams",params:b,method:"GET"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取指定交易单元下未被分组的交易员失败",c(b)})},b.getTradersForEdit=function(b,c){a({url:"/tradeTeamManage/getTradersForEdit",params:b,method:"GET"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取getTradersForEdit交易员失败",c(b)})},b.getTeamTraders=function(b,c){a({url:"/tradeTeamManage/getTeamTraders",params:b,method:"GET"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取指定小组的小组成员及小组组长信息失败",c(b)})},b.addNewTeam=function(b,c){a({url:"/tradeTeamManage/addNewTeam",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="新建小组数据插入失败",c(b)})},b.teamsInfo=function(b,c){a({url:"/tradeTeamManage/teamsInfo",params:b,method:"GET"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取交易单元下小组详细信息",c(b)})},b.editTeamConfirm=function(b,c){a({url:"/tradeTeamManage/editTeamConfirm",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="确认编辑小组失败",c(b)})},b.delGid=function(b,c){a({url:"/tradeTeamManage/delGid",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="确认删除小组信息失败",c(b)})},b}),cspServices.factory("operLoginService",function(a){var b={};return b.cspOperCheckLogin=function(b,c){a({url:"/operlogin/checklogin",params:b,method:"POST"}).success(function(a){c(a)}).error(function(a){var b={};b.result="failed",b.reason="服务器连接失败",c(b)})},b.cspOperLogin=function(b,c){a({url:"/operlogin/login",params:b,method:"POST"}).success(function(a){c(a)}).error(function(a){var b={};b.result="failed",b.reason="服务器连接失败",c(b)})},b.cspOperCheckAndLogin=function(b,c){a({url:"/operlogin/checkandlogin",params:b,method:"POST"}).success(function(a){c(a)}).error(function(a){var b={};b.result="failed",b.reason="服务器连接失败",c(b)})},b.cspOperCheckIdcard=function(a){var b=a,c={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏 ",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外 "},d=0;if(!/^\d{17}(\d|x)$/i.test(b))return!1;if(b=b.replace(/x$/i,"a"),null==c[parseInt(b.substr(0,2))])return!1;var e=b.substr(6,4)+"-"+Number(b.substr(10,2))+"-"+Number(b.substr(12,2)),f=new Date(e.replace(/-/g,"/"));if(e!=f.getFullYear()+"-"+(f.getMonth()+1)+"-"+f.getDate())return!1;for(var g=17;g>=0;g--)d+=Math.pow(2,g)%11*parseInt(b.charAt(17-g),11);return d%11==1},b.cspOperCheckGroupAndGetList=function(b,c){a({url:"/operlogin/checkgroupandgetlist",params:b,method:"GET"}).success(function(a){c(a)}).error(function(a){var b={};b.result="failed",b.reason="服务器连接失败",c(b)})},b.cspOperLoginOut=function(b,c){a({url:"/operlogin/loginout",params:b,method:"POST"}).success(function(a){c(a)}).error(function(a){var b={};b.result="failed",b.reason="服务器连接失败",c(b)})},b}),cspServices.factory("operManageService",function(a){var b={};return b.cspOperManageGetAllMaid=function(b,c){a({url:"/opermanage/getallmaid",params:b,method:"GET"}).success(function(a){c(a)}).error(function(a){var b={};b.result="failed",b.reason="服务器连接失败",c(b)})},b.cspOperManageGetOidByMaid=function(b,c){a({url:"/opermanage/getoidbymaid",params:b,method:"GET"}).success(function(a){c(a)}).error(function(a){var b={};b.result="failed",b.reason="服务器连接失败",c(b)})},b.cspOperManageGetOperByOid=function(b,c){a({url:"/opermanage/getoperbyoid",params:b,method:"GET"}).success(function(a){c(a)}).error(function(a){var b={};b.result="failed",b.reason="服务器连接失败",c(b)})},b.cspOperManageAddOper=function(b,c){a({url:"/opermanage/addoper",params:b,method:"POST"}).success(function(a){c(a)}).error(function(a){var b={};b.result="failed",b.reason="服务器连接失败",c(b)})},b.cspOperManageUpdateOper=function(b,c){a({url:"/opermanage/updateoper",params:b,method:"POST"}).success(function(a){c(a)}).error(function(a){var b={};b.result="failed",b.reason="服务器连接失败",c(b)})},b.cspOperManageChangeOperStat=function(b,c){a({url:"/opermanage/changeoperstat",params:b,method:"POST"}).success(function(a){c(a)}).error(function(a){var b={};b.result="failed",b.reason="服务器连接失败",c(b)})},b.cspOperManageResetPass=function(b,c){a({url:"/opermanage/resetpass",params:b,method:"POST"}).success(function(a){c(a)}).error(function(a){var b={};b.result="failed",b.reason="服务器连接失败",c(b)})},b.cspOperManageGetCaidByMaid=function(b,c){a({url:"/opermanage/getcaidbymaid",params:b,method:"GET"}).success(function(a){c(a)}).error(function(a){var b={};b.result="failed",b.reason="服务器连接失败",c(b)})},b.cspOperManageGetTridByCaid=function(b,c){a({url:"/opermanage/gettridbycaid",params:b,method:"GET"}).success(function(a){c(a)}).error(function(a){var b={};b.result="failed",b.reason="服务器连接失败",c(b)})},b.cspOperManageAddTrader=function(b,c){a({url:"/opermanage/addtrader",params:b,method:"POST"}).success(function(a){c(a)}).error(function(a){var b={};b.result="failed",b.reason="服务器连接失败",c(b)})},b}),cspServices.factory("randomService",function(a){var b={};return b.getWishTid=function(b,c){a({url:"/random/getWishTid",params:b,method:"GET"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取交易单元下的小组失败",c(b)})},b.unitRandmDiv=function(b,c){a({url:"/random/unitRandmDiv",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="分券失败",c(b)})},b.deleResults=function(b,c){a({url:"/random/deleResults",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="清除分券结果失败",c(b)})},b.writeResults=function(b,c){a({url:"/random/writeResults",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="写入分券结果失败",c(b)})},b.writeSec=function(b,c){a({url:"/random/writeSec",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="更改总券失败",c(b)})},b.recoverStock=function(b,c){a({url:"/random/recoverStock",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="恢复总券失败",c(b)})},b.noWishList=function(b,c){a({url:"/random/noWishList",params:b,method:"GET"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取是否所有小组均没有心愿清单失败",c(b)})},b.deleWishList=function(b,c){a({url:"/random/deleWishList",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="分券完毕后删除心愿清单失败",c(b)})},b.getRandmR=function(b,c){a({url:"/random/getRandmR",params:b,method:"GET"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="分券完毕后获取分券结果失败",c(b)})},b.randomOver=function(b,c){a({url:"/random/randomOver",params:b,method:"GET"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="分券完毕后检查总券是否有剩余券失败",c(b)})},b.getTname=function(b,c){a({url:"/random/getTname",params:b,method:"GET"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="根据小组gid获取小组名称失败",c(b)})},b.getInfobyGid=function(b,c){a({url:"/random/getInfobyGid",params:b,method:"GET"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="根据小组gid获取小组杠杆/分券市值失败",c(b)})},b}),cspServices.factory("tradeUnitStockService",function(a){var b={};return b.getStocksByTrade=function(b,c){a({url:"/tradeUnitStockService/getStocksByTrade",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取所有资产单元失败",c(b)})},b.loadStockFile=function(b,c){a({url:"/tradeUnitStockService/loadStockFile",data:b,method:"POST",headers:{"Content-Type":void 0},transformRequest:angular.identity}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="上传券表文件失败",c(b)})},b.importStock=function(b,c){a({url:"/tradeUnitStockService/importStock",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取所有资产单元失败",c(b)})},b.saveEditStock=function(b,c){a({url:"/tradeUnitStockService/saveEditStock",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="编辑券表数据失败",c(b)})},b.delStock=function(b,c){a({url:"/tradeUnitStockService/delStock",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="删除券表数据失败",c(b)})},b.getStockAmountByTrade=function(b,c){a({url:"/tradeUnitStockService/getStockAmountByTrade",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取券表数量失败",c(b)})},b.createStock=function(b,c){a({url:"/tradeUnitStockService/createStock",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="创建券表数据失败",c(b)})},b.loadStockFileAndImport=function(b,c){a({url:"/tradeUnitStockService/loadStockFileAndImport",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="导入数据失败",c(b)})},b}),cspServices.factory("unitManageService",function(a){var b={};return b.getValidAssetUnit=function(b,c){a({url:"/unitManageService/getValidAssetUnit",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取所有资产单元失败",c(b)})},b.getTotalAssetUnit=function(b,c){a({url:"/unitManageService/getTotalAssetUnit",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取所有资产单元失败",c(b)})},b.getAssetUnitFromCapManager=function(b,c){a({url:"/unitManageService/getAssetUnitFromCapManager",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取所有资产单元失败",c(b)})},b.getAllValidCapManager=function(b,c){a({url:"/unitManageService/getAllValidCapManager",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取所有有效的资产管理人失败",c(b)})},b.getAllCapManager=function(b,c){a({url:"/unitManageService/getAllCapManager",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取所有资产管理人失败",c(b)})},b.saveEditAssetUnit=function(b,c){a({url:"/unitManageService/saveEditAssetUnit",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="编辑资产单元失败",c(b)})},b.createAssetUnit=function(b,c){a({url:"/unitManageService/createAssetUnit",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="创建资产单元失败",c(b)})},b.saveEditAssetManager=function(b,c){a({url:"/unitManageService/saveEditAssetManager",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="编辑资产管理人失败",c(b)})},b.createAssetManager=function(b,c){a({url:"/unitManageService/createAssetManager",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="创建资产管理人失败",c(b)})},b.saveEditTradeUnit=function(b,c){a({url:"/unitManageService/saveEditTradeUnit",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="编辑交易单元失败",c(b)})},b.createTradeUnit=function(b,c){a({url:"/unitManageService/createTradeUnit",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="创建交易单元失败",c(b)})},b.getTransUnitFromAssetUnit=function(b,c){a({url:"/unitManageService/getTransUnitFromAssetUnit",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取所有交易单元失败",c(b)})},b.getAllAssetManagers=function(b,c){a({url:"/unitManageService/getAllAssetManagers",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取所有资产管理人失败",c(b)})},b.getAllAssetUnits=function(b,c){a({url:"/unitManageService/getAllAssetUnits",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取所有资产管理人失败",c(b)})},b.getAllAssetTraders=function(b,c){a({url:"/unitManageService/getAllAssetTraders",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取所有资产管理人失败",c(b)})},b.frozenAssetManager=function(b,c){a({url:"/unitManageService/frozenAssetManager",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="冻结资产管理人失败",c(b)})},b.frozenAssetUnit=function(b,c){a({url:"/unitManageService/frozenAssetUnit",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="冻结资产单元失败",c(b)})},b.frozenTradeUnit=function(b,c){a({url:"/unitManageService/frozenTradeUnit",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="冻结交易单元失败",c(b)})},b.unfreezeAssetManager=function(b,c){a({url:"/unitManageService/unfreezeAssetManager",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="解冻资产管理人失败",c(b)})},b.unfreezeAssetUnit=function(b,c){a({url:"/unitManageService/unfreezeAssetUnit",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="解冻资产单元失败",c(b)})},b.unfreezeTradeUnit=function(b,c){a({url:"/unitManageService/unfreezeTradeUnit",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="解冻交易单元失败",c(b)})},b.getNewManagerid=function(b,c){a({url:"/unitManageService/getNewManagerid",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="解冻交易单元失败",c(b)})},b.getNewCaid=function(b,c){a({url:"/unitManageService/getNewCaid",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="解冻交易单元失败",c(b)})},b.getNewTrid=function(b,c){a({url:"/unitManageService/getNewTrid",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="解冻交易单元失败",c(b)})},b}),cspServices.factory("wishListService",function(a){var b={};return b.getTidModel=function(b,c){a({url:"/wishList/getTidModel",params:b,method:"GET"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取交易小组失败",c(b)})},b.getUnitStocks=function(b,c){a({url:"/wishList/getUnitStocks",params:b,method:"GET"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取交易单元券表失败",c(b)})},b.submitWishList=function(b,c){a({url:"/wishList/submitWishList",params:b,method:"POST"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="保存心愿清单失败",c(b)})},b.getGroupBpValue=function(b,c){
a({url:"/wishList/getGroupBpValue",params:b,method:"GET"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取小组总BP失败",c(b)})},b.getGroupWishList=function(b,c){a({url:"/wishList/getGroupWishList",params:b,method:"GET"}).success(function(a){console.log(a),c(a)}).error(function(a){var b={};b.result=!1,b.reason="获取小组心愿清单失败",c(b)})},b});